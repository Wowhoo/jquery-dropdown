/*! jquery dropdown - v0.1.1 - 2013-12-11
* https://github.com/amazingSurge/jquery-dropdown
* Copyright (c) 2013 amazingSurge; Licensed MIT */
(function(t){var s=t.dropdown=function(e,i){this.element=e,this.$element=t(e),this.$parent=this.$element.parent();var n=[];t.each(this.$element.data(),function(t,s){var e=RegExp("^dropdown","i");e.test(t)&&(n[t.toLowerCase().replace(e,"")]=s)}),this.options=t.extend(!0,{},s.defaults,i,n),this.namespace=this.options.namespace,this.classes={skin:this.namespace+"_"+this.options.skin,show:this.namespace+"_show",trigger:this.namespace+"-trigger",mask:this.namespace+"-mask",wrapper:this.namespace+"-wrapper",panel:this.namespace+"-panel",disabled:this.namespace+"_disabled"},null!==this.options.skin&&this.$element.addClass(this.classes.skin),this.$children=this.$element.children(),this.$panel=this._parse(this.options.panel),this.isShow=!1,this.disabled=!1,this.init()};s.prototype={constructor:s,init:function(){var s=this;this.$parent.addClass(this.classes.wrapper),this.$element.addClass(this.namespace).addClass(this.classes.trigger),this.$panel.addClass(this.classes.panel),this.$element.on("click.dropdown",function(){return s.toggle.call(s),!1}),this.$panel.on("click.dropdown","li",function(){return"function"==typeof s.options.onChange&&s.options.onChange.call(s,t(this)),s.options.imitateSelect&&s.setText(t(this)),s.$element.trigger("dropdown::onChange",t(this)),s.hide(),!1}),"function"==typeof this.options.onInit&&this.options.onInit.call(this,this),this.$element.trigger("dropdown::init",this)},show:function(){var s=this;this.disabled||(this.options.clickoutHide&&this._generateMask(),t(window).on("resize.dropdown",function(){return s._position(),!1}),this.isShow=!0,this.$element.addClass(this.classes.show),this.$panel.addClass(this.classes.show),this._position(),"function"==typeof this.options.onShow&&this.options.onShow.call(this,this),this.$element.trigger("dropdown::show",this))},hide:function(){this.isShow=!1,this.options.clickoutHide&&this._clearMask(),this.$element.removeClass(this.classes.show),this.$panel.removeClass(this.classes.show),t(document).off("mousedown.dropdown"),"function"==typeof this.options.onHide&&this.options.onHide.call(this,this),this.$element.trigger("dropdown::hide",this)},setText:function(t){this.$element.text(t.text()),this.$children.length&&this.$children.appendTo(this.$element)},_generateMask:function(){var s=this;this.$mask=t("<div></div>").addClass(this.classes.mask).appendTo(this.$parent),this.$mask.on("click.dropdown",function(){return s.hide(),!1})},_clearMask:function(){this.$mask&&(this.$mask.off(".dropdown"),this.$mask.remove(),this.$mask=null)},toggle:function(){this.isShow?this.hide():this.show()},_position:function(){var s,e,i=this.$element.offset(),n=this.$element.outerHeight(),o=this.$element.outerWidth(),h=this.$panel.outerWidth(!0),a=this.$panel.outerHeight(!0);s=a+n+i.top>t(window).height()+t(window).scrollTop()?-a:n,e=h+i.left>t(window).width()+t(window).scrollLeft()?o-h:0,this.$panel.css({position:"absolute",top:s,left:e})},_parse:function(s){return s.indexOf("+")>=0?this.$element.next():t(this.options.panel)},enable:function(){this.disabled=!1,this.$wrapper.removeClass(this.classes.disabled)},disable:function(){this.disabled=!0,this.$wrapper.addClass(this.classes.disabled)},destory:function(){this.hide(),this.$element.off(".dropdown"),this.$element.remove(),t(window).off(".dropdown")}},s.defaults={namespace:"dropdown",skin:null,panel:"+",clickoutHide:!0,imitateSelect:!1,onInit:null,onShow:null,onHide:null,onChange:null},t.fn.dropdown=function(e){if("string"==typeof e){var i=e,n=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var s=t.data(this,"dropdown");"function"==typeof s[i]&&s[i].apply(s,n)})}return this.each(function(){t.data(this,"dropdown")||t.data(this,"dropdown",new s(this,e))})}})(jQuery);